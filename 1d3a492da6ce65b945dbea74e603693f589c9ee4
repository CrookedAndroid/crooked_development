{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "ed989f53_826abca2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1890625
      },
      "writtenOn": "2021-08-05T11:43:05Z",
      "side": 1,
      "message": "Hi all, this commits could apply to all branches. Because it\u0027s my 1st time to submit, and there\u0027s so many branches here, I don\u0027t know which branch is the best one, so I choose this branch as one start point. \n\nWhy we need to check the $TARGET_PRODUCT env variable? Because most developers working on some specific PRODUCT (e.g. coral from Google, venus from Xiaomi). Once we changed the ABI interface of one library (e.g. external lib in .so format), and ran the `mmm .` command to compile this single library, one error message would appear saying \"you need to run `${path}/blah/blah/create_reference_dumps.py -l \u003clibname\u003e` to refresh/generate the latest ABI infomation for this lib\". \n\nIf following this error message, I run \"${path}/blah/blah/create_reference_dumps.py -l \u003clibname\u003e\", the problem comes. this python script will generate the ABI info for the default product (e.g. aosp_arm), and the real product (defined as TARGET_PRODUCT) could not get the ABI info updates.\n\nIf there\u0027s any questions, please let me know. Thanks.",
      "revId": "1d3a492da6ce65b945dbea74e603693f589c9ee4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9db08eab_66e79e7d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1130827
      },
      "writtenOn": "2021-08-06T07:18:12Z",
      "side": 1,
      "message": "Master branch is the appropriate branch.\n\nThe ABI is required to be consistent among all Android products in order to keep the system updatable. That\u0027s the reason why the script dumps ABI from generic products, and your product\u0027s ABI is compared with the generic ABI.\n\nThe ABI tool can be configured to allow some ABI difference without updating dumps. We would like to know your case and help with it. Could you explain it here or on issuetracker.google.com ?",
      "parentUuid": "ed989f53_826abca2",
      "revId": "1d3a492da6ce65b945dbea74e603693f589c9ee4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8e4643e9_bf1a0139",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1890625
      },
      "writtenOn": "2021-08-06T08:00:27Z",
      "side": 1,
      "message": "Thanks for your reply. \n\nFor ordinary gerrit\u0027s operation, seems that any changes committed to the \"master\" branch are prohibitted. So I turned one normal branch this time.\n\nAbout the ABI consistant, here is one short description, and I could file one issue on issuetracker. \n\nThe short version: \nthe \"external/libnl\" package lacks of link-related APIs, so I added \"lib/route/link/api.c\", \"lib/route/link.c\" and \"src/lib/utils.c\" to the android.bp file. Along with these c files, there should be one \u0027if.h\u0027 file to describe the interface flags and device mapping structure. \nBesides, all the existing APIs are NOT modified. \n\u003d\u003d\n\nSome ABI differences might trigge the updating operation, but this time the difference is detected, and through one error message saying that I need to run this python script, but do not mention the \"-products\" option, which updated the ABIs for wrong product.",
      "revId": "1d3a492da6ce65b945dbea74e603693f589c9ee4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "65693954_cc8ecb4a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1890625
      },
      "writtenOn": "2021-08-06T08:00:27Z",
      "side": 1,
      "message": "Thanks for your reply. \nFor ordinary gerrit\u0027s operation, seems that any changes committed to the \"master\" branch are prohibitted. So I turned one normal branch this time.\n\nAbout the ABI consistant, here is one short description, and I could file one issue on issuetracker. \n\nThe short version: \nthe \"external/libnl\" package lacks of link-related APIs, so I added \"lib/route/link/api.c\", \"lib/route/link.c\" and \"src/lib/utils.c\" to the android.bp file. Along with these c files, there should be one \u0027if.h\u0027 file to describe the interface flags and device mapping structure. \nBesides, all the existing APIs are NOT modified. \n\u003d\u003d\n\nSome ABI differences might trigge the updating operation, but this time the difference is detected, and through one error message saying that I need to run this python script, but do not mention the \"-products\" option, which updated the ABIs for wrong product.",
      "parentUuid": "9db08eab_66e79e7d",
      "revId": "1d3a492da6ce65b945dbea74e603693f589c9ee4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a64d2a0c_2dc8eb58",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1130827
      },
      "writtenOn": "2021-08-06T09:33:57Z",
      "side": 1,
      "message": "We cannot merge this patch to AOSP because we intend to generate ABI dumps from generic products.\n\nIf you want to add and check ABI extension for your own products, you can modify the script or the ABI dumps in your branch.\n\nIf you want to add the extension but not trigger the build error, you can add\nprebuilts/abi-dumps/vndk/30/64/arm64_armv8-a/source-based/config.ini\n\nThe file content is:\n\n[global]\nallow_extensions \u003d true\n\nThere is document about config.ini. The available options are listed in\nhttps://cs.android.com/android/platform/superproject/+/master:development/vndk/tools/header-checker/src/diff/header_abi_diff.cpp;l\u003d170",
      "parentUuid": "65693954_cc8ecb4a",
      "revId": "1d3a492da6ce65b945dbea74e603693f589c9ee4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}